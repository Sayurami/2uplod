<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Gojo Gallery</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    img { width: 200px; display: block; margin: 10px 0; }
    .delete-btn { display: none; color: red; cursor: pointer; }
  </style>
</head>
<body>
  <h1>üì∏ Gojo Gallery</h1>

  <div id="login">
    <input type="text" id="username" placeholder="Admin Username">
    <input type="password" id="password" placeholder="Admin Password">
    <button onclick="loginAdmin()">Login</button>
  </div>

  <div id="gallery"></div>

  <script>
    let isAdmin = false;
    let adminCreds = {};

    function loginAdmin() {
      const username = document.getElementById("username").value;
      const password = document.getElementById("password").value;
      if (!username || !password) return alert("Enter login details!");

      adminCreds = { username, password };
      isAdmin = true;
      localStorage.setItem("isAdmin", "true");
      alert("‚úÖ Logged in as Admin");
      loadGallery();
    }

    async function loadGallery() {
      const res = await fetch("/uploads/");
      const files = await res.json();
      const gallery = document.getElementById("gallery");
      gallery.innerHTML = "";

      files.forEach(f => {
        const div = document.createElement("div");
        div.innerHTML = `
          <p><b>${f.name || f.filename}</b></p>
          <img src="/file/${f.id}">
          <button class="delete-btn" onclick="deleteFile('${f.id}')">üóëÔ∏è Delete</button>
          <hr>
        `;
        gallery.appendChild(div);
      });

      if (isAdmin || localStorage.getItem("isAdmin") === "true") {
        document.querySelectorAll(".delete-btn").forEach(btn => btn.style.display = "inline-block");
      }
    }

    async function deleteFile(id) {
      if (!confirm("Delete this file?")) return;
      await fetch(`/uploads/${id}`, {
        method: "DELETE",
        headers: {
          username: adminCreds.username,
          password: adminCreds.password
        }
      });
      loadGallery();
    }

    loadGallery();
  </script>
</body>
</html>
