<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SL ANIME WORLD</title>

  <!-- üîë Google Site Verification -->
  <meta name="google-adsense-account" content="ca-pub-4517560700517113">

  <style>
    body { 
      font-family: Arial, sans-serif; 
      background: #f5f5f5; 
      margin: 0;
      padding: 0;
      transition: background 0.3s, color 0.3s;
    }
    header {
      background: #222;
      color: #fff;
      padding: 15px;
      text-align: center;
      position: relative;
    }
    nav {
      display: flex;
      justify-content: center;
      gap: 20px;
      background: #333;
      padding: 10px;
      flex-wrap: wrap;
    }
    nav a {
      color: #fff;
      text-decoration: none;
      font-weight: bold;
    }
    nav a:hover { text-decoration: underline; }

    /* üçî Hamburger */
    .hamburger {
      display: none;
      flex-direction: column;
      gap: 4px;
      position: absolute;
      left: 15px;
      top: 20px;
      cursor: pointer;
    }
    .hamburger div {
      width: 25px;
      height: 3px;
      background: #fff;
    }
    .nav-links {
      display: flex;
      gap: 20px;
    }
    .nav-links.active {
      display: block;
      text-align: center;
      width: 100%;
    }

    /* Search bar */
    #searchBar {
      margin: 20px auto;
      display: block;
      width: 80%;
      max-width: 400px;
      padding: 8px;
      border-radius: 5px;
      border: 1px solid #aaa;
    }

    /* Gallery */
    .gallery { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; margin-top: 20px; }
    .gallery-item { width: 200px; border: 1px solid #ddd; border-radius: 8px; padding: 10px; background: #fff; }
    .gallery-item img { width: 100%; height: 150px; object-fit: cover; border-radius: 8px; cursor: pointer; }
    .gallery-item h3, .gallery-item p { margin: 5px 0; word-break: break-word; }
    .gallery-item button { margin-top: 5px; padding: 5px 10px; cursor: pointer; }

    /* Forms */
    form { margin: 20px auto; display: none; flex-direction: column; align-items: center; gap: 10px; }
    #loginBox { margin: 20px auto; display: none; flex-direction: column; align-items: center; gap: 10px; width: 250px; background: #fff; padding: 15px; border-radius: 8px; box-shadow: 0 0 5px #aaa; }

    /* üåô Dark Theme */
    .dark { background: #222; color: #eee; }
    .dark nav { background: #111; }
    .dark .gallery-item { background: #333; border: 1px solid #555; }

    /* ‚òÄÔ∏è Theme Toggle */
    .theme-toggle { position: fixed; top: 15px; right: 15px; padding: 10px; border: none; border-radius: 50%; cursor: pointer; font-size: 20px; }

    /* üìû Contact Box */
    #contactBox { margin-top: 40px; padding: 15px; border-radius: 8px; background: #fff; box-shadow: 0 0 5px #aaa; display: inline-block; }
    .dark #contactBox { background: #333; }

    /* Footer */
    footer {
      margin-top: 40px;
      background: #222;
      color: #ddd;
      text-align: center;
      padding: 15px;
    }
    footer a { color: #ddd; margin: 0 10px; text-decoration: none; }
    footer a:hover { text-decoration: underline; }

    /* üì± Responsive */
    @media(max-width:768px) {
      nav { flex-direction: column; align-items: center; }
      .nav-links { display: none; flex-direction: column; gap: 10px; }
      .hamburger { display: flex; }
    }
  </style>
</head>
<body class="light">

<header>
  <h1>üåêüìΩÔ∏è SL ANIME WORLD</h1>
  <!-- üçî -->
  <div class="hamburger" onclick="toggleMenu()">
    <div></div><div></div><div></div>
  </div>
</header>

<!-- ‚òÄÔ∏èüåô Theme Toggle -->
<button class="theme-toggle" onclick="toggleTheme()">‚òÄÔ∏è</button>

<!-- Navigation Bar -->
<nav>
  <div class="nav-links">
    <a href="#">Home</a>
    <a href="#categories">Categories</a>
    <a href="#about">About</a>
    <a href="#contactBox">Contact</a>
    <a href="#privacy">Privacy Policy</a>
  </div>
</nav>

<main>
  <!-- üîç Search -->
  <input type="text" id="searchBar" placeholder="Search anime..." onkeyup="searchGallery()">

  <!-- Upload form (admin only) -->
  <form id="uploadForm" enctype="multipart/form-data">
    <input type="file" name="photo" accept="image/*" required />
    <input type="text" name="name" placeholder="Photo Name" required />
    <textarea name="description" placeholder="Photo Description (support links)" rows="2" required></textarea>
    <button type="submit">Upload</button>
  </form>

  <!-- Login Box -->
  <div id="loginBox">
    <h3>üîë Admin Login</h3>
    <input type="text" id="username" placeholder="Username" />
    <input type="password" id="password" placeholder="Password" />
    <button onclick="login()">Login</button>
  </div>

  <!-- Login toggle button -->
  <button id="loginToggle">Admin Login</button>

  <!-- Gallery -->
  <section id="categories">
    <h2>üìÇ Categories</h2>
    <div class="gallery" id="gallery"></div>
  </section>

  <!-- üìñ About -->
  <section id="about">
    <h2>‚ÑπÔ∏è About Us</h2>
    <p>Welcome to SL ANIME WORLD! We share anime wallpapers, reviews, and updates. Our mission is to create a free anime hub for Sri Lankan anime lovers.</p>
  </section>

  <!-- üìû Contact -->
  <div id="contactBox">
    <h3>üìû Contact Owner</h3>
    <p>WhatsApp: <a href="https://wa.me/94743826406" target="_blank">0743826406</a></p>
  </div>

  <!-- üîê Privacy -->
  <section id="privacy">
    <h2>üîê Privacy Policy</h2>
    <p>We respect your privacy. Any personal data collected will not be shared. For more details, please check our full Privacy Policy & Terms.</p>
  </section>
</main>

<footer>
  <p>¬© 2025 SL ANIME WORLD. All Rights Reserved.</p>
  <a href="#privacy">Privacy Policy</a> | 
  <a href="#">Terms & Conditions</a> | 
  <a href="#">Disclaimer</a>
</footer>

<script>
const form = document.getElementById('uploadForm');
const gallery = document.getElementById('gallery');
const loginBox = document.getElementById('loginBox');
const loginToggle = document.getElementById('loginToggle');
let isAdmin = false;

// üçî Toggle menu
function toggleMenu() {
  document.querySelector('.nav-links').classList.toggle('active');
}

// üîë Hard-coded admin credentials
const ADMIN_USER = "sayura";
const ADMIN_PASS = "Sayura2008***7";

// Convert links in text
function linkify(text) {
  const urlRegex = /(https?:\/\/[^\s]+)/g;
  return text.replace(urlRegex, url => `<a href="${url}" target="_blank">${url}</a>`);
}

// Load gallery
async function loadGallery() {
  try {
    const res = await fetch('/uploads/');
    const items = await res.json();
    gallery.innerHTML = '';
    items.forEach(item => {
      const div = document.createElement('div');
      div.className = 'gallery-item';
      div.innerHTML = `
        <img src="/file/${item.id}" onclick="window.open('/file/${item.id}', '_blank')" />
        <h3>${item.name}</h3>
        <p>${linkify(item.description)}</p>
        <button onclick="downloadPhoto('/file/${item.id}')">Download</button>
        ${isAdmin ? `<button onclick="deletePhoto('${item.id}')">Delete</button>` : ""}
      `;
      gallery.appendChild(div);
    });
  } catch {
    gallery.innerHTML = "<p>‚ö†Ô∏è Failed to load gallery</p>";
  }
}

// üîç Search filter
function searchGallery() {
  let input = document.getElementById("searchBar").value.toLowerCase();
  let items = document.getElementsByClassName("gallery-item");
  Array.from(items).forEach(item => {
    let text = item.textContent.toLowerCase();
    item.style.display = text.includes(input) ? "block" : "none";
  });
}

// Download
function downloadPhoto(url) {
  const link = document.createElement('a');
  link.href = url;
  link.download = url.split('/').pop();
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}

// Delete (admin only)
async function deletePhoto(fileId) {
  if (!confirm('Delete this photo?')) return;
  const res = await fetch('/uploads/' + fileId, { 
    method: 'DELETE',
    headers: { "Authorization": "Basic " + btoa(ADMIN_USER + ":" + ADMIN_PASS) }
  });
  const data = await res.json();
  if (data.success) loadGallery();
}

// Upload (admin)
form.addEventListener('submit', async e => {
  e.preventDefault();
  if (!isAdmin) return alert("‚ùå Only admin can upload");
  const formData = new FormData(form);
  const res = await fetch('/upload', { method: 'POST', body: formData });
  const data = await res.json();
  if (data.success) { loadGallery(); form.reset(); }
});

// Toggle login box
loginToggle.addEventListener('click', () => {
  loginBox.style.display = loginBox.style.display === 'flex' ? 'none' : 'flex';
});

// Admin login
function login() {
  const username = document.getElementById('username').value.trim();
  const password = document.getElementById('password').value.trim();
  if (username === ADMIN_USER && password === ADMIN_PASS) {
    isAdmin = true;
    loginBox.style.display = 'none';
    form.style.display = 'flex';
    alert('‚úÖ Admin logged in!');
    loadGallery();
  } else alert('‚ùå Wrong username or password');
}

// üåô‚òÄÔ∏è Theme toggle
function toggleTheme() {
  document.body.classList.toggle('light');
  document.body.classList.toggle('dark');
  document.querySelector('.theme-toggle').textContent =
    document.body.classList.contains('dark') ? 'üåô' : '‚òÄÔ∏è';
}

// Init
loadGallery();
</script>
</body>
</html>
